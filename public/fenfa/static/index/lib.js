function buy(_tid){var xhr=new XMLHttpRequest();xhr.open("GET",in_path+"source/pack/weixin/buy.php?tid="+_tid,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){if(xhr.responseText==-1){layer.msg($.i18n.prop('msg_qxdlzcz'));}else{$(".dialog-mask").show();$(".buy-confirm").show();$("#qrcode").attr("src",in_path+"source/pack/weixin/qrcode.php?link="+encodeURIComponent(xhr.responseText));}}else{layer.msg($.i18n.prop('msg_txyc'));}}};xhr.send(null);}
function pay(_rmb){var xhr=new XMLHttpRequest();xhr.open("GET",in_path+"source/pack/weixin/pay.php?rmb="+_rmb,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){if(xhr.responseText==-1){layer.msg($.i18n.prop('msg_qxdlzcz'));}else{$(".dialog-mask").show();$(".buy-confirm").show();$("#qrcode").attr("src",in_path+"source/pack/weixin/qrcode.php?link="+encodeURIComponent(xhr.responseText));}}else{layer.msg($.i18n.prop('msg_txyc'));}}};xhr.send(null);}
function login(){var xhr=new XMLHttpRequest();var mail=document.getElementById("mail");var pwd=document.getElementById("pwd");document.getElementById("alert-warning").style.display="block";if(strLen(mail.value)<1||isEmail(mail.value)==false){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yygsyw') +"</li></ul>";mail.focus();return;}
if(strLen(pwd.value)<1){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_mmbnwk') +"</li></ul>";pwd.focus();return;}
xhr.open("GET",in_path+"source/index/ajax.php?ac=login&mail="+mail.value+"&pwd="+pwd.value,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){if(xhr.responseText=="return_1"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yyysd') +"</li></ul>";}else if(xhr.responseText=="return_2"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_dlxxbpp') +"</li></ul>";}else if(xhr.responseText=="return_3"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_dlcgqsd') +"</li></ul>";setTimeout("location.href='"+home_link+"'",1e3);}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_nbcxcw') +"</li></ul>";}}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_txyc') +"</li></ul>";}}};xhr.send(null);}
function reg(){var xhr=new XMLHttpRequest();var mail=document.getElementById("mail");var pwd=document.getElementById("pwd");var rpwd=document.getElementById("rpwd");var seccode=document.getElementById("seccode");document.getElementById("alert-warning").style.display="block";if(strLen(mail.value)<1||isEmail(mail.value)==false){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yygsyw') +"</li></ul>";mail.focus();return;}
if(strLen(pwd.value)<6){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_mmcdlw') +"</li></ul>";pwd.focus();return;}
if(rpwd.value!==pwd.value){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_lcsrmmbyy') +"</li></ul>";rpwd.focus();return;}
if(strLen(seccode.value)!=4){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_qssswyzm') +"</li></ul>";seccode.focus();return;}
xhr.open("GET",in_path+"source/index/ajax.php?ac=reg&mail="+mail.value+"&pwd="+rpwd.value+"&seccode="+seccode.value,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){if(xhr.responseText=="return_1"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yzmywqgz') +"</li></ul>";}else if(xhr.responseText=="return_2"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yyybzy') +"</li></ul>";}else if(xhr.responseText=="return_3"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_zzcgqsd') +"</li></ul>";setTimeout("location.href='"+home_link+"'",1e3);}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_nbcxcw') +"</li></ul>";}}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_txyc') +"</li></ul>";}}};xhr.send(null);}
function send_mail(){var xhr=new XMLHttpRequest();var mail=document.getElementById("mail");document.getElementById("alert-warning").style.display="block";if(strLen(mail.value)<1||isEmail(mail.value)==false){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yygsyw') +"</li></ul>";mail.focus();return;}
document.getElementById("send_btn").innerHTML="获取中...";xhr.open("GET",in_path+"source/index/ajax.php?ac=send&mail="+mail.value,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){if(xhr.responseText=="return_0"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yjffzwkq') +"</li></ul>";}else if(xhr.responseText=="return_1"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yybcz') +"</li></ul>";}else if(xhr.responseText=="return_2"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_qddssm') +"</li></ul>";}else if(xhr.responseText=="return_4"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yjmyfsyx') +"</li></ul>";}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_bqyjmwsf') +"</li></ul>";}}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+  $.i18n.prop('msg_txyc') +"</li></ul>";}
document.getElementById("send_btn").innerHTML="重新获取";}};xhr.send(null);}
function lost(){var xhr=new XMLHttpRequest();var mail=document.getElementById("mail");var mcode=document.getElementById("mcode");var pwd=document.getElementById("pwd");var rpwd=document.getElementById("rpwd");document.getElementById("alert-warning").style.display="block";if(strLen(mail.value)<1||isEmail(mail.value)==false){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yzmywqgz') +"</li></ul>";mail.focus();return;}
if(strLen(mcode.value)<1){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yjmbnwk') +"</li></ul>";mcode.focus();return;}
if(strLen(pwd.value)<6){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_mmcdlw') +"</li></ul>";pwd.focus();return;}
if(rpwd.value!==pwd.value){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_lcsrmmbyy') +"</li></ul>";rpwd.focus();return;}
xhr.open("GET",in_path+"source/index/ajax.php?ac=lost&mail="+mail.value+"&pwd="+rpwd.value+"&mcode="+mcode.value,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){if(xhr.responseText=="return_1"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yybcz') +"</li></ul>";}else if(xhr.responseText=="return_2"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_yzmywqgz') +"</li></ul>";}else if(xhr.responseText=="return_3"){document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_czcg') +"</li></ul>";setTimeout("location.href='"+login_link+"'",1e3);}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_nbcxcw') +"</li></ul>";}}else{document.getElementById("alert-warning").innerHTML="<ul><li>"+ $.i18n.prop('msg_txyc') +"</li></ul>";}}};xhr.send(null);}
function strLen(str){var charset=document.charset;var len=0;for(var i=0;i<str.length;i++){len+=str.charCodeAt(i)<0||str.charCodeAt(i)>255?charset=="gbk"?3:2:1;}
return len;}
function isEmail(input){if(input.match(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)){return true;}
return false;}